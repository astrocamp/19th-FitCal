{% extends 'layouts/default.html' %} {% block main %}
<h1>店家資訊</h1>
<div>店家名稱：{{ store.name }}</div>
<div>店家地址：{{ store.address }}</div>
<div>店家電話：{{ store.phone_number }}</div>
<div>店家統編：{{ store.tax_id }}</div>
<div>開店時間：{{ store.opening_time }}</div>
<div>打烊時間：{{ store.closing_time }}</div>

<h2>所有商品</h2>
<ul>
  {% for product in products %}
  <li class="p-1.5 border rounded mb-1 w-[30%]">
    <a href="{% url 'products:show' product.id %}">
      <section>商品名稱：{{ product.name }} - 價錢：{{ product.price }}</section>
    </a>
    {% if user.is_authenticated and user.is_member %}
    <div x-data="{ qty: 1 }" class="flex justify-between">
      <input type="number" name="quantity" x-model="qty" min="1" class="w-16 text-center border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500" />
      <button hx-post="{% url 'carts:create_cart_item' product.id %}" hx-include="input[name='quantity']" hx-target="#messages-container" hx-swap="innerHTML" class="btn">加入購物車</button>
    </div>
    {% endif %}
  </li>
  {% empty %}
  <li>這個店家目前沒有商品。</li>
  {% endfor %}
</ul>
{% if user.is_store and store == user.store %}
<form action="{% url 'stores:delete' store.id %}" method="post" onsubmit="return confirm('是否確認刪除帳號與店家？此操作無法復原！')">
  {% csrf_token %}
  <button type="submit" class="btn">刪除帳號</button>
</form>

{% if request.user.is_authenticated %}
<form method="POST" action="{% url 'users:delete_session' %}" style="margin-top: 1rem">
  {% csrf_token %}
  <button type="submit" class="btn">登出</button>
</form>
{% endif %}

<a href="{% url 'stores:edit' store.id %}" class="btn">編輯</a>
<a href="{% url 'products:new' store.id %}" class="btn btn-primary"> 新增商品 </a>
{% endif %}
<a href="{% url 'stores:index' %}" class="btn">回上一頁</a>
{% endblock main %}
