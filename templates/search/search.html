{% load static %} {% comment %} 初始資料注入 {% endcomment %}
<script>
  window.__initialSearchKeyword = "{{ request.GET.q|default:'' }}";
  window.__initialMaxCalories = parseInt("{{ request.GET.max_calories|default:'0' }}");
</script>

{% comment %} 表單 HTML {% endcomment %}
<form
  x-data="searchFormComponent()"
  id="searchForm"
  action="{% url 'search:index' %}"
  method="get"
  class="flex flex-col gap-0 max-w-sm"
  @click.away="showFilter = false"
>
  <input
    id="searchInput"
    name="q"
    type="text"
    placeholder="搜尋商家、餐點或餐點卡路里"
    class="input input-bordered w-53"
    value="{{ request.GET.q }}"
    @focus="showFilter = true"
  />

  <div
    id="calorieFilter"
    class="transition-[max-height] duration-300 overflow-hidden"
    x-ref="filter"
    x-bind:style="showFilter ? 'max-height:' + $refs.filter.scrollHeight + 'px' : 'max-height: 0;'"
  >
    <label for="max_calories" class="block text-xs mt-2">
      最多卡路里(非必填)：<span x-text="maxCalories"></span>
    </label>
    <input
      type="range"
      id="max_calories"
      name="max_calories"
      min="0"
      max="1000"
      step="10"
      x-model="maxCalories"
      class="range w-56 h-3"
    />
  </div>

  <button id="searchBtn" type="submit" class="btn w-56 mt-2">搜尋</button>
</form>

{% comment %} 引入打包後 JS {% endcomment %}
<script type="module" src="{% static 'assets/scripts/app.js' %}"></script>
